<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprint Tracker - TripFactory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background: #f1f5f9; }
        .update-item { transition: all 0.2s; }
        .update-item:hover { background-color: #f8fafc; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    
    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-40">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-4">
                    <div class="h-10 w-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold">TF</div>
                    <div>
                        <h1 class="text-xl font-bold text-slate-800">Sprint Tracker</h1>
                        <p class="text-xs text-slate-500">Meeting Notes & Progress Updates</p>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="exportUpdates()" class="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-medium transition">
                        <i class="fas fa-download mr-2"></i>Export
                    </button>
                    <button onclick="window.location.href='index.html'" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition">
                        <i class="fas fa-arrow-left mr-2"></i>Back to Hub
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Add New Update Form -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                <i class="fas fa-plus-circle text-blue-600"></i>
                Add New Update
            </h2>
            
            <form id="updateForm" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Date</label>
                        <input type="date" id="updateDate" required
                               class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Meeting Type</label>
                        <select id="meetingType" required
                                class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                            <option value="Daily Standup">Daily Standup</option>
                            <option value="Sprint Planning">Sprint Planning</option>
                            <option value="Sprint Review">Sprint Review</option>
                            <option value="Retrospective">Retrospective</option>
                            <option value="Client Meeting">Client Meeting</option>
                            <option value="Technical Discussion">Technical Discussion</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Subject / Title</label>
                    <input type="text" id="meetingSubject" placeholder="e.g., Capeye Workflow Review" required
                           class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Meeting Notes / Updates</label>
                    <textarea id="meetingNotes" rows="4" placeholder="Enter key points, decisions, blockers, next steps..." required
                              class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none"></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Attendees (comma separated)</label>
                    <input type="text" id="attendees" placeholder="e.g., Ajay, Raj, Sarah" 
                           class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none">
                </div>
                
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="isBlocker" class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500">
                    <label for="isBlocker" class="text-sm font-medium text-red-600">
                        <i class="fas fa-exclamation-triangle mr-1"></i>Mark as Blocker/Issue
                    </label>
                </div>
                
                <div class="flex gap-3 pt-2">
                    <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition">
                        <i class="fas fa-save mr-2"></i>Save Update
                    </button>
                    <button type="button" onclick="clearForm()" class="px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-lg transition">
                        Clear
                    </button>
                </div>
            </form>
        </div>

        <!-- Filters -->
        <div class="flex flex-wrap gap-2 mb-6">
            <button onclick="filterUpdates('all')" class="filter-btn px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium transition" data-filter="all">All Updates</button>
            <button onclick="filterUpdates('blocker')" class="filter-btn px-4 py-2 bg-white text-slate-600 border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition" data-filter="blocker">
                <i class="fas fa-exclamation-triangle text-red-500 mr-1"></i>Blockers
            </button>
            <button onclick="filterUpdates('Daily Standup')" class="filter-btn px-4 py-2 bg-white text-slate-600 border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition" data-filter="Daily Standup">Daily Standups</button>
            <button onclick="filterUpdates('Sprint Planning')" class="filter-btn px-4 py-2 bg-white text-slate-600 border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition" data-filter="Sprint Planning">Sprint Planning</button>
        </div>

        <!-- Updates List -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200">
            <div class="p-4 border-b border-slate-200 flex justify-between items-center">
                <h2 class="text-lg font-bold text-slate-800">Updates History</h2>
                <span id="updateCount" class="text-sm text-slate-500">0 updates</span>
            </div>
            <div id="updatesList" class="divide-y divide-slate-200">
                <!-- Updates will be inserted here -->
                <div class="p-8 text-center text-slate-500">
                    <i class="fas fa-clipboard-list text-4xl mb-3 text-slate-300"></i>
                    <p>No updates yet. Add your first meeting note above.</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Initialize
        let updates = JSON.parse(localStorage.getItem('tf_updates')) || [];
        
        // Set today's date as default
        document.getElementById('updateDate').valueAsDate = new Date();
        
        // Form submission
        document.getElementById('updateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const update = {
                id: Date.now(),
                date: document.getElementById('updateDate').value,
                type: document.getElementById('meetingType').value,
                subject: document.getElementById('meetingSubject').value,
                notes: document.getElementById('meetingNotes').value,
                attendees: document.getElementById('attendees').value,
                isBlocker: document.getElementById('isBlocker').checked,
                createdAt: new Date().toISOString()
            };
            
            updates.unshift(update); // Add to top
            localStorage.setItem('tf_updates', JSON.stringify(updates));
            
            renderUpdates();
            clearForm();
            showNotification('Update saved successfully');
        });
        
        function renderUpdates(filter = 'all') {
            const container = document.getElementById('updatesList');
            const countSpan = document.getElementById('updateCount');
            
            let filteredUpdates = updates;
            if (filter === 'blocker') {
                filteredUpdates = updates.filter(u => u.isBlocker);
            } else if (filter !== 'all') {
                filteredUpdates = updates.filter(u => u.type === filter);
            }
            
            countSpan.textContent = `${filteredUpdates.length} update${filteredUpdates.length !== 1 ? 's' : ''}`;
            
            if (filteredUpdates.length === 0) {
                container.innerHTML = `
                    <div class="p-8 text-center text-slate-500">
                        <i class="fas fa-clipboard-list text-4xl mb-3 text-slate-300"></i>
                        <p>No updates found.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredUpdates.map(update => `
                <div class="update-item p-4 ${update.isBlocker ? 'bg-red-50 border-l-4 border-red-500' : ''}" data-id="${update.id}">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center gap-3">
                            <span class="px-2 py-1 ${getTypeColor(update.type)} text-xs font-medium rounded">
                                ${update.type}
                            </span>
                            ${update.isBlocker ? '<span class="px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded"><i class="fas fa-exclamation-triangle mr-1"></i>BLOCKER</span>' : ''}
                            <span class="text-sm text-slate-500">
                                <i class="far fa-calendar mr-1"></i>${formatDate(update.date)}
                            </span>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editUpdate(${update.id})" class="text-slate-400 hover:text-blue-600 transition" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteUpdate(${update.id})" class="text-slate-400 hover:text-red-600 transition" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <h3 class="font-bold text-slate-800 mb-2">${escapeHtml(update.subject)}</h3>
                    
                    <div class="text-sm text-slate-600 mb-3 whitespace-pre-wrap">${escapeHtml(update.notes)}</div>
                    
                    ${update.attendees ? `
                        <div class="text-xs text-slate-500 mb-2">
                            <i class="fas fa-users mr-1"></i>Attendees: ${escapeHtml(update.attendees)}
                        </div>
                    ` : ''}
                    
                    <div class="text-xs text-slate-400">
                        Added: ${formatDateTime(update.createdAt)}
                    </div>
                </div>
            `).join('');
        }
        
        function getTypeColor(type) {
            const colors = {
                'Daily Standup': 'bg-blue-100 text-blue-700',
                'Sprint Planning': 'bg-purple-100 text-purple-700',
                'Sprint Review': 'bg-green-100 text-green-700',
                'Retrospective': 'bg-orange-100 text-orange-700',
                'Client Meeting': 'bg-pink-100 text-pink-700',
                'Technical Discussion': 'bg-cyan-100 text-cyan-700',
                'Other': 'bg-slate-100 text-slate-700'
            };
            return colors[type] || colors['Other'];
        }
        
        function filterUpdates(type) {
            // Update button styles
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.dataset.filter === type) {
                    btn.className = 'filter-btn px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium transition';
                } else {
                    btn.className = 'filter-btn px-4 py-2 bg-white text-slate-600 border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition';
                }
            });
            
            renderUpdates(type);
        }
        
        function editUpdate(id) {
            const update = updates.find(u => u.id === id);
            if (!update) return;
            
            document.getElementById('updateDate').value = update.date;
            document.getElementById('meetingType').value = update.type;
            document.getElementById('meetingSubject').value = update.subject;
            document.getElementById('meetingNotes').value = update.notes;
            document.getElementById('attendees').value = update.attendees;
            document.getElementById('isBlocker').checked = update.isBlocker;
            
            // Remove old version
            updates = updates.filter(u => u.id !== id);
            localStorage.setItem('tf_updates', JSON.stringify(updates));
            renderUpdates();
            
            // Scroll to form
            document.getElementById('updateForm').scrollIntoView({ behavior: 'smooth' });
        }
        
        function deleteUpdate(id) {
            if (!confirm('Delete this update?')) return;
            
            updates = updates.filter(u => u.id !== id);
            localStorage.setItem('tf_updates', JSON.stringify(updates));
            renderUpdates();
            showNotification('Update deleted');
        }
        
        function clearForm() {
            document.getElementById('updateForm').reset();
            document.getElementById('updateDate').valueAsDate = new Date();
        }
        
        function exportUpdates() {
            const data = {
                updates: updates,
                exportDate: new Date().toISOString(),
                totalCount: updates.length
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sprint-updates-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            showNotification('Updates exported');
        }
        
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
        }
        
        function formatDateTime(isoStr) {
            const date = new Date(isoStr);
            return date.toLocaleString('en-GB', { 
                day: 'numeric', 
                month: 'short', 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function showNotification(message) {
            const div = document.createElement('div');
            div.className = 'fixed bottom-4 right-4 px-6 py-3 bg-green-600 text-white rounded-lg shadow-lg z-50 flex items-center gap-2';
            div.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 3000);
        }
        
        // Initial render
        renderUpdates();
    </script>
</body>
</html>
